# –ò–º—è workflow, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ GitHub Action
name: Deploy to Docker Server
run-name: "üöÄ Deploy: ${{ github.event.head_commit.message || 'Manual run' }}"

# –¢—Ä–∏–≥–≥–µ—Ä ‚Äî –∑–∞–ø—É—Å–∫–∞—Ç—å workflow –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø—É—à–µ –≤ –≤–µ—Ç–∫—É main
on:
  push:
    branches:
      - main

jobs:
  deploy:
    # GitHub Actions –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤—Å—ë –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π Ubuntu
    runs-on: ubuntu-latest

    steps:
      # üîπ –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —à–∞–≥ ‚Äî –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –ø–æ SSH –∫ —Å–µ—Ä–≤–µ—Ä—É
      - name: Trigger SSH connection to start deploy
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.DEPLOY_KEY }}
          script: |
            echo "Connecting to server... deploy should start automatically"
          # –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–µ—Ä –≤—ã–ø–æ–ª–Ω–∏—Ç —Å–∫—Ä–∏–ø—Ç.sh
